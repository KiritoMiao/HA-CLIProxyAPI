title: CLIProxyAPI Mobile
path: cliproxyapi-mobile
icon: mdi:cellphone
type: sections
max_columns: 1
sections:
  - type: grid
    cards:
      - type: heading
        heading: Health
      - type: tile
        entity: binary_sensor.cliproxyapi_reachable
      - type: tile
        entity: sensor.cliproxyapi_error_rate
      - type: tile
        entity: sensor.cliproxyapi_total_requests
      - type: tile
        entity: sensor.cliproxyapi_failed_requests
      - type: tile
        entity: sensor.cliproxyapi_total_tokens

  - type: grid
    cards:
      - type: heading
        heading: Quick Actions
      - type: horizontal-stack
        cards:
          - type: button
            entity: button.cliproxyapi_refresh_data
            show_state: false
          - type: button
            entity: button.cliproxyapi_clear_log_files
            show_state: false
            tap_action:
              action: perform-action
              confirmation:
                text: Clear CLIProxyAPI logs?
              perform_action: button.press
              target:
                entity_id: button.cliproxyapi_clear_log_files

  - type: grid
    cards:
      - type: heading
        heading: Controls
      - type: entities
        show_header_toggle: false
        entities:
          - switch.cliproxyapi_debug_mode
          - switch.cliproxyapi_log_to_file
          - switch.cliproxyapi_usage_statistics
          - number.cliproxyapi_request_retry_count
          - number.cliproxyapi_max_retry_interval

  - type: grid
    cards:
      - type: heading
        heading: Per-Key Usage
      - type: entities
        show_header_toggle: false
        entities:
          - sensor.cliproxyapi_tracked_key_usage_entries
      - type: custom:auto-entities
        card:
          type: entities
          title: Per-key requests (auto)
          show_header_toggle: false
        filter:
          include:
            - entity_id: sensor.cliproxyapi_key_*_requests
          exclude: []
        sort:
          method: state
          numeric: true
          reverse: true
        show_empty: false
      - type: custom:auto-entities
        card:
          type: entities
          title: Per-key used tokens (auto)
          show_header_toggle: false
        filter:
          include:
            - entity_id: sensor.cliproxyapi_key_*_tokens
          exclude: []
        sort:
          method: state
          numeric: true
          reverse: true
        show_empty: false
      - type: custom:auto-entities
        card:
          type: entities
          title: Per-key input tokens (auto)
          show_header_toggle: false
        filter:
          include:
            - entity_id: sensor.cliproxyapi_key_*_input_tokens
          exclude: []
        sort:
          method: state
          numeric: true
          reverse: true
        show_empty: false
      - type: custom:auto-entities
        card:
          type: entities
          title: Per-key output tokens (auto)
          show_header_toggle: false
        filter:
          include:
            - entity_id: sensor.cliproxyapi_key_*_output_tokens
          exclude: []
        sort:
          method: state
          numeric: true
          reverse: true
        show_empty: false
      - type: custom:auto-entities
        card:
          type: entities
          title: Per-key cached tokens (auto)
          show_header_toggle: false
        filter:
          include:
            - entity_id: sensor.cliproxyapi_key_*_cached_tokens
          exclude: []
        sort:
          method: state
          numeric: true
          reverse: true
        show_empty: false
      - type: markdown
        content: |
          Add key sensors to this section after discovery.

          Example:
          - `sensor.cliproxyapi_key_a1b2c3d4_requests`
          - `sensor.cliproxyapi_key_a1b2c3d4_tokens`
          - `sensor.cliproxyapi_key_a1b2c3d4_input_tokens`
          - `sensor.cliproxyapi_key_a1b2c3d4_output_tokens`
          - `sensor.cliproxyapi_key_a1b2c3d4_cached_tokens`

  - type: grid
    cards:
      - type: heading
        heading: Per-Model Spend
      - type: custom:auto-entities
        card:
          type: entities
          title: Model input tokens (auto)
          show_header_toggle: false
        filter:
          include:
            - entity_id: sensor.cliproxyapi_model_*_input_tokens
          exclude: []
        sort:
          method: state
          numeric: true
          reverse: true
        show_empty: false
      - type: custom:auto-entities
        card:
          type: entities
          title: Model output tokens (auto)
          show_header_toggle: false
        filter:
          include:
            - entity_id: sensor.cliproxyapi_model_*_output_tokens
          exclude: []
        sort:
          method: state
          numeric: true
          reverse: true
        show_empty: false
      - type: custom:auto-entities
        card:
          type: entities
          title: Model cached tokens (auto)
          show_header_toggle: false
        filter:
          include:
            - entity_id: sensor.cliproxyapi_model_*_cached_tokens
          exclude: []
        sort:
          method: state
          numeric: true
          reverse: true
        show_empty: false
